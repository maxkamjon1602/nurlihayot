extends layout

block content
    ul(class="container-fluid nav nav-tabs udetail-umenu px-2 pt-2")
        li(class="dropdown flex-grow-1" id="udetail-uname")
            a(class="dropdown-toggle" id="udetail-uname-a" data-bs-toggle="dropdown" href="#")= username
                span(class="caret")
            ul(class="dropdown-menu")
                li
                    a(href="#" id="udetail-acc-change") Switch account
        li
            a(href="#")
                i(class="bi bi-view-list")
                span(class="d-none d-md-inline d-lg-inline mx-1") Views
        li
            a(class="me-2" href="#")
                i(class="bi bi-person-gear")
                span(class="d-none d-md-inline d-lg-inline mx-1") Account
    
    
    div(class="container_fluid udetail-prof p-2")
        div(class="d-flex flex-row udetail-heading")
            div(class="flex-fill p-0")
                img(src=`data:image/${avatar.file.contentType};base64, ${avatar.file.data.toString('base64')}`)
            div(class="d-flex flex-fill align-self-center p-0 udetail-stats")    
                a(class="mx-2 ms-4 p-0" href="#")
                    p(class="m-0 p-0 udetail-stats-num") 15 m
                    p(class="m-0 p-0")
                        small likes
                a(class="mx-2 p-0" href="#")
                    p(class="m-0 p-0 udetail-stats-num") 240 m
                    p(class="m-0 p-0")
                        small following
                a(class="mx-2 p-0" href="#")
                    p(class="m-0 p-0 udetail-stats-num") 24.8 k
                    p(class="m-0 p-0")
                        small followers
        div(class="row")
            p(class="udetail-fullname") #{user.firstName}  #{user.lastName}


    ul(class="nav nav-tabs" id="myTab" role="tablist")
        li(class="nav-item" role="presentation")
            button(class="nav-link active" id="home-tab" data-bs-toggle="tab" data-bs-target="#home" type="button" role="tab" aria-controls="home" aria-selected="true") Posts
        li(class="nav-item" role="presentation")
            button(button class="nav-link" id="article-tab" data-bs-toggle="tab" data-bs-target="#article" type="button" role="tab" aria-controls="article" aria-selected="false") Articles
        li(class="nav-item" role="presentation")
            button(button class="nav-link" id="blog-tab" data-bs-toggle="tab" data-bs-target="#blog" type="button" role="tab" aria-controls="blog" aria-selected="false") Blogs


    div(class="tab-content")
        div(class="tab-pane active" id="home" role="tabpanel" aria-labelledby="home-tab")
            div(class="row")
                //- each arrPostMedia in postMedia
                    each post in arrPostMedia
                        script.
                            console.log(`!{post}`);

                        if post[0] !== undefined
                        else
                            p= post.title
                                


                            a(class="col-4 col-sm-4 p-0 m-0 udetail-postlink" id="postlink" href=`/post/${post[0].url}`)
                                //- img(class="img-responsive" src=`data:image/${post[0].file.contentType};base64, ${post[0].file.data.toString('base64')}`)

        div(class="tab-pane" id="article" role="tabpanel" aria-labelledby="article-tab")
        div(class="tab-pane" id="blog" role="tabpanel" aria-labelledby="blog-tab")
    
    
    
    script.
        console.log("!{user.firstName}")


    

    hr

    h3 
        each val, index in userList
            a(href=val.url) #{val.name}
            if index < userList.length - 1
                |,
        else
            p This user is not available.

    p Bio: #{user.bio ? user.bio : ''}
    p Date of birth: #{user.dob ? user.dob : ''}
    p Created at: #{user.created_formatted ? user.created_formatted : ''}
    p 
        a(href=`/addresses/${user.id}`) Address: 
        each address in userAddress
            if address !== undefined
                | #{userAddress[0].lineOne}, #{userAddress[0].city}, #{userAddress[0].postcode}
    p Tel.: #{user.telephone ? user.telephone : ''}
    p Email: #{user.email ? user.email : ''}
    p Accounts:
    
    each index in user.accounts
        if index.kind == "internal"
            p
                a(href=user.url) #{index.username}
        else
            p #{index.kind} 
                a(href=`${index.kind}.com`) #{index.uid}

    //- each arrPostMedia in postMedia
        each post in arrPostMedia
            if post[0] === undefined
                p= post.title 
                p #[em #{post.description}]
                p #{post.created_formatted}
            else 
                img(src=`data:image/${post[0].file.contentType};base64, ${post[0].file.data.toString('base64')}` width='300px' heigth='300px')

    hr
    a(href=`${user.id}/settings/`) Settings
    


    //- script !{getAdmin}
    //- script.
    //-     const btnGetAdmin = document.getElementById("getAdmin");
    //-     btnGetAdmin.addEventListener("click", getAdmin);
    //-     function getAdmin(){
    //-         var url = window.location.pathname;
    //-         var id = url.substring(url.lastIndexOf('/') + 1);

    //-         console.log(id);
    //-     }